# Telegram 群组消息爬取工具

一个基于 Python 和 PyQt6 开发的 Telegram 群组消息爬取工具，支持图形界面操作，可以方便地获取和导出群组消息数据。

## 功能特点

### 1. 基础功能
- 支持通过群组 ID 爬取消息
- 支持设置消息爬取数量限制
- 支持指定起始时间爬取
- 支持代理设置（SOCKS5/SOCKS4/HTTP）
- 自动保存配置信息

### 2. 消息获取
- 支持获取文本消息
- 支持下载媒体文件（图片、视频、文档、音频）
- 获取消息发送者信息
- 获取消息查看数
- 支持分批获取，避免请求过于频繁

### 3. 数据分析
- 实时统计信息显示
- 消息预览功能
- 详细的统计分析：
  * 总消息数统计
  * 发言人数统计
  * 媒体消息统计
  * 消息时间分布分析
  * 活跃用户排名

### 4. 数据导出
- 支持导出为 Excel 文件
- 多个数据表：
  * 原始消息数据
  * 统计数据汇总
  * 发言人统计分析

## 使用说明

### 1. 环境要求
- Python 3.7+
- PyQt6
- telethon
- pandas
- PySocks

### 2. 配置说明
1. API 配置：
   - 需要在 [Telegram API](https://my.telegram.org/apps) 获取 API ID 和 API Hash
   - 首次使用需要进行手机号验证

2. 代理设置：
   - 支持 SOCKS5、SOCKS4、HTTP 代理
   - 默认代理端口：3067
   - 可在界面中修改代理配置

### 3. 使用步骤
1. 填写配置信息：
   - API ID
   - API Hash
   - 群组 ID（支持多种格式：数字ID、用户名、邀请链接）

2. 设置爬取参数：
   - 爬取数量（可选）
   - 起始时间（将爬取此时间之前的消息）

3. 开始爬取：
   - 点击"开始采集"按钮
   - 查看实时进度和统计信息

4. 导出数据：
   - 点击"导出Excel"按钮
   - 选择保存位置
   - 自动生成多个数据表

### 4. 数据格式
导出的 Excel 文件包含以下表格：
1. 消息数据：
   - 发送者信息（ID、用户名、显示名称）
   - 消息内容
   - 发送时间
   - 查看数
   - 媒体类型及路径

2. 统计数据：
   - 总体统计信息
   - 媒体类型分布
   - 时间分布统计

3. 发言人统计：
   - 发言次数排名
   - 人均查看数
   - 媒体消息统计

## 注意事项
1. 请确保代理服务正常运行
2. 大量消息爬取时请注意时间间隔
3. 首次使用需要进行 Telegram 验证
4. 请确保有足够的存储空间（如需下载媒体文件）
5. 建议在稳定的网络环境下使用

## 更新日志
- 添加消息预览功能
- 改进统计分析展示
- 优化时区处理
- 添加用户信息缓存
- 改进错误提示 

## 安装说明

1. 克隆仓库： 


2. 创建并激活虚拟环境：
bash
python -m venv venv
source venv/bin/activate # Linux/Mac
或
venv\Scripts\activate # Windows
3. 安装依赖： 
pip install -r requirements.txt

4. 运行程序：
```bash
python src/main.py
```